<div align="center">

 ![header](https://capsule-render.vercel.app/api?type=shark&height=300&text=📬SOM📬&desc=%20%20Sound%20of%20mind&textBg=false&fontColor=FFFFFF&section=header&fontSize=70&fontAlign=50&fontAlignY=49&animation=fadeIn)

 **[플레이 데이터] 한화시스템 BEYOND SW캠프 3기**/☁️**SOM TEAM**☁️

 </div>

<br>

<div align="center">
 
## &nbsp;📬[SOM데모 사이트 바로가기](https://www.naver.com)

</div>

<div align="center">

 ## ☁️팀원☁️

[**이혜선** 🐴](https://github.com/hyesunlee30) (표준화개발)
<br>
[**이창선** 🐷](https://github.com/keepself) (표준화개발)
 <br>
[**송보석** 🐭](https://github.com/fa7271) (서비스개발)
<br>
[**장준혁** 🐰](https://github.com/GreatJang) (서비스개발)


<br>

---

</br>

##  💻STACK

</div>


<div align=center> 

<img src="https://img.shields.io/badge/java-007396?style=for-the-badge&logo=java&logoColor=white">
<img src="https://img.shields.io/badge/vue.js-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white">
<img src="https://img.shields.io/badge/linux-FCC624?style=for-the-badge&logo=linux&logoColor=black">
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/mariaDB-003545?style=for-the-badge&logo=mariaDB&logoColor=white">
<img src="https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=Redis&logoColor=white">
<img src="https://img.shields.io/badge/spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white">
<img src="https://img.shields.io/badge/docker-2496ED?style=for-the-badge&logo=docker&logoColor=white">
<img src="https://img.shields.io/badge/jirasoftware-0052CC?style=for-the-badge&logo=jirasoftware&logoColor=white">


<br>

---

<br>

</div>

## 프로젝트 관리

![image](https://github.com/fa7271/som/assets/48422615/67dfd253-9f41-4da9-8950-bb7ff46f00d4)



##  📋ERD 

<div align="center">
 
<img src="https://github.com/fa7271/som/assets/150704738/5722a510-9e79-4e60-ae85-aca6912cfdc0" width="800" height="600"/>

</div>

<br>

---

</br>

<br><br><br>

## 🌠프로젝트 소개

**Q)어떤계기에서 이 프로그램이 시작되었나요?**

<br>

개발자와 일을 할 때, 개발자를 움직이는 마법의 단어가 있습니다 **“고민이 있어요”**
개발자 4명이 모여서 한 달 동안 개발을 하는데 꼭 도움이 되는 개발을 하고 싶다고 생각했습니다.<br/>
서비스의 목표이자 저희 프로젝트의 이름인
**The Soud Of Mind** 는 한 에피소드에서 시작되는데요
누군가 다음날이 오기전 선생님께 “저는 이만 떠납니다.” 라고 남긴거였죠.
처음엔 누가 남긴지 모르는 메세지였지만 꼬리가 밟혔고 결국 저희 조원 창선이인것이 들통났습니다.

**이 에피소드에서 저희 팀은 아이디어를 얻었습니다!**
대부분은 자신의 고민을 말하기 싫어할 것 입니다.
혹은 자신의 고민을 말할 곳이 없을 수도 있을 것입니다.
하지만 해결은 하고싶을때.
**“익명의 고민을 들어주고 방향을 제시해주는 서비스”**
그점을 제안하는 것 입니다.

## 🎯프로젝트 목표

**Q)이 프로그램을 통해서 도달하고싶은 목표는 무었인가요?**

<br>

**개발**에 빗대어 저희 목표를 알려드리자면,
사람들의 스피드는 다르고, 선행 학습의 양도 다릅니다. 섣부르게 재능과 능력을 판단해서는 안된다고 생각하는데요.
근데 혼자 가면 힘들 수 있으니 같이 가자는 게 저희 팀에 생각입니다.
개발자는 고민을 해결해주는 사람이라고 생각합니다. 고민이 있는 사람들의 목소리를 들을 수 있는 그리고 그 고민을 해결해줄 수 있는 개발자로 성장하길 바라는 마음으로 만들었습니다.
**단지 개발 기술만이 아니라, 자신의 힘듦, 속마음 등을 나눌 수 있고
따뜻한 마음을 전할 수 있는 !고민 전문! 게시판이 되었으면 합니다.**

<br>

## 🔍 요구사항 명세서

<details>
<summary>자세히 보기(click)</summary>


|구분|요구사항 명|요구사항 설명|
|:---:|:---:|:---:|
|**Batch**|member rangking update|매일 새벽에 배치로 30 일전부터 어제까지의 총 댓글 개수 * 10 점, 총 글 개수 * 3 점으로 계산해서 랭킹|
|**MSA**|MSA|모놀리식 구조에서 springbatch 적용을 위한 MSA 구조 적용 |
||빌드|docker-compose를 이용한 docker 로컬 배포|
|**Common**|공통 에러 처리|공통 에러 처리|
|**Admin**|사용자 비활성화|사용자 관리 페이지에서 비활성화 버튼 선택시 사용자 active =false|
||security 적용|filter, config 작성 및 확인|
||사용자 비활성화|사용자 관리 페이지에서 비활성화 버튼 선택시 사용자 active =false|
||사용자 페이징 리스트|최신순 페이징 된 사용자 리스트 반환 검색필터(제목,닉네임) 적용|
||사용자 수정|사용자 수정버튼 클릭시 사용자 수정 페이지로 이동해 수정(닉네임)|
||사용자 상세보기|사용자 email로 검색된 사용자 상세 정보 보기|
||회원가입|닉네임, 이메일, 패스워드로 가입 이메일 인증으로 인증코드 전달 후 인증코드 확인하여 active =true, redis에 인증 토큰 저장|
||로그인|이메일, 패스워드로 로그인 후 토큰 반환 |
||로그아웃|토큰과 롤 삭제 후 사용자 리스트로 이동|
||패스워드 찾기|이메일 인증으로 패스워드 리셋 후 다시 셋팅|
||내부통신|board에 rangking,nickname 정보 전달|이메일LIST 파라미터로 받아 랭킹,닉네임 반환|
||내부통신|board에 rangkin top 10 전달|board에 rangkin top 10 전달|
|**Board**|게시글 작성|게시글 작성시 욕설, 링크 를 포함하면 작성은 가능하되 "*" 표시로 바뀌어서 표시|
||게시글 작성|게시글을 하루(당일, 00 시 넘어가면 초기화)에 5 개 초과로 작성할 수 없음|
||게시글 작성|한 게시글 좋아요는 한 개만 가능하다.|
||게시글 조회|게시글, 댓글 등에서 사용자 정보를 보여주는 부분에 랭킹도 함께 보여준다.|
||게시글 리스트 페이징 및 검색|최신순, 게시글 리스트를 글 10개씩 페이징하여 리스트 출력, 검색필터(제목,닉네임)를 적용|
||랭킹 TOP 10|랭킹 TOP 10 보여주기|
||일간 조회수 TOP 10|일간 조회수 TOP 10 보여주기|
||주간 조회수 TOP 10|주간 조회수 TOP 10 보여주기|
||월간 조회수 TOP 10|월간 조회수 TOP 10 보여주기|
||게시글 삭제|게시글을 삭제할 수 있다. 본인과 어드민 가능|
||게시글 작성|vue 관련 에디터 적용|
|**Comment**|댓글 리스트|게시글에서 최신순으로 댓글을 확인할 수 있다.|
||댓글 작성|"게시글에 댓글을 달 수 있는 부분이 있고 댓글을 작성 후 다시 상세정보를 호출해 댓글을 확인할 수 있다"|
||댓글 삭제|"자신이 단 댓글을 삭제할 수 있다. 어드민의 경우 자신이 작성한 댓글이아니어도 삭제할 수 있다"|
</details>

<br>

---

</br>
<br><br><br>

##  📋기술 설계도

<div align="center">

<img src="https://github.com/fa7271/som/assets/150704738/7ac41841-1dc2-4717-bdd7-5461c26e08e8" width="800" height="600"/>
</div>

SOM 프로젝트의 개발적인 목표는 프로젝트를 실무에서 여러 팀원들, 타 팀과의 소통을 하며 장기적으로 유지보수한다는 관점에서 현재 주어진 기간 안에 최선을 다해 장기적으로 지속 가능한 프로젝트로 개발하는 것이었습니다.

표준화개발팀 이혜선, 이창선과 서비스개발팀 송보석 장준혁으로 팀을 분리하여 관리 책임 및 기능 개발을 진행했습니다.   
표준화개발에서는 표준화된 스켈레톤과 공통 라이브러리, 계정 관리 및 보안 배포 등을 담당하였으며 서비스개발팀에서는 익명게시판 서비스 기능들을 개발하였습니다. 

<br><br><br>

## 원활한 커뮤니케이션을 위한 익명게시판 개발


![image](https://github.com/fa7271/som/assets/48422615/9badb8d5-b829-47cc-b63b-c2ccd441515c)

<br>

**랭킹**
처음 기획단계에서는 모놀로식 프로젝트였습니다. 원활한 커뮤니케이션을 위한 익명게시판 개발을 개발하겠다는 목표를 세우고, 어떻게 하면 더 많은 참여와 트래픽을 이끌어낼 수 있을지 생각하게 되었고 그게 바로 랭킹이었습니다. 

30일이라는 기간동안의 활동성을 포인트로 전환하여 5분 단위의 배치를 통해 랭킹리스트를 생성합니다. 전 계정의 데이터를 움직이는 배치 작업은 모놀로식 서비스일 경우 부하가 생겨 다른 서비스에 영향을 줄 수 있어 Spring Cloud MSA와 Spring Batch를 도입하였습니다.

Job 별로 Step, Tasklet(하나의 작업), Chunk(reader, processor, witer) 등 대용량 데이터를 단계별 배치작업을 진행할 수 있으며, 배치 Job에 대한 메타 데이터의 확인을 통해 Job에 대한 모니터링이 가능합니다. 

<br>

**조회수**
사용자가 게시글을 클릭했을때 조회수가 올라갑니다. 
<<더미 데이터이기 때문에 VIEWS 테이블에 있는 숫자 기준으로 날짜별로 가장 높은 10개의 postid를 가지고
Post 테이블에서 가져오기 때문에 post 테이블의 Views 숫자와 다를 수 있습니다 >>
어뷰징 금지를 위해서 게시글 본 이력을 레디스에 userid가 키이고 user가 본 postid들을 저장합니다.
매일00시00분에 각 post에 조회수를 세서 디비에 postid 1개당 하나의 컬럼이 들어가고 일간,주간, 월간 조회수를 구할때 @query로 구해온다.

<br><br><br>

## 모놀로식에서 MSA 로!


![image](https://github.com/fa7271/som/assets/48422615/20d7ed76-3ce5-4db8-9f69-0c8b20dff1ef)

MSA 아키텍처 도입으로 프론트 vue(localhost:3000)에서 오는 요청은 게이트웨이를 통해 내부 서비스로 연결됩니다. 

[localhost:8000](http://localhost:8000) 포트를 게이트웨이가 사용하게 되는데, 게이트웨이에서는 들어오는 요청의 path에 따라 discovery에 등록되어 있는 서비스로 요청을 돌려주게 됩니다. 

표준화개발팀이 운영하는 admin 서비스가 가지고 있는 계정정보들이 필요할 시에는 서비스개발팀이 운영하는 post 서비스에서 spring cloud 라이브러리 중 하나인 open feign 을 운영해 내부통신해서 받아가게 됩니다. discovery에 등록된 name을 호출하는 feign client를 만들고 그 안에 호출하는 함수들을 선언합니다. 

보안은 각 서비스 마다 적용하여, 서비스가 요청될 때 보안 필터체인을 타도록 했습니다.
feign을 통한 internal 서비스 요청은 permitAll 하여 인증없이 통과되도록 하였습니다.

<br><br><br>

## 익명게시판을 악의적으로 사용하는 유저에 대한 제재 


**관리자만의 슈퍼 권한**
익명게시판이지만 자신이 글을 달고 다른 사람인척 댓글을 다는 익명유저를 관리하기 위해 어드민은 닉네임을 확인할 수 있습니다. 
또한 어드민은 유저 계정을 비활성화 하거나, 악의적인 글과 댓글을 삭제할 수 있습니다.

**욕필터링**
사용자가 댓글, 포스트 작성에 욕을 작성시에 욕을 필터링 하기 위해 구현하였습니다.

로직 순서는 사용자가 포스트를 작성하거나, , 댓글달기를 하면 컨트롤러를 가기전에 인터셉터를 거칩니다.
인터셉터에 등록된 url이 들어오면 preHandle 메소드를 호출하면서 들어온 값이 댓글내용인지 , 게시글내용인지를 확인하여 필터링 클래스르 호출합니다.
욕의 종류들을 담은 인터페이스와BadWords 인터페이스를 구현하고 있는 클래스가 , 욕설 단어가 포함되어 있는지 확인할 수 있습니다.

pre_change 메서드: 이 메서드는 주어진 텍스트에서 정규식을 사용하여 한글, 영문, 공백 문자를 제외한 다른 문자를 필터링하는 역할을 합니다.
export_html 메서드: 이 메서드는 주어진 HTML 문서에서 욕설을 필터링하고, 필터링된 텍스트로 변경하여 HTML을 변환합니다. Jsoup 라이브러리를 사용하여 HTML을 파싱하고, 각 요소의 텍스트를 필터링하여 변경합니다.

change 메서드: 이 메서드는 주어진 텍스트에서 대소문자를 무시하고 주어진 욕설 단어를 대체값으로 변경합니다. 예를들어 병신새끼 처럼 혹은 욕이 두개로 합쳐져 있는경우나 욕 사이에 숫자 특수문자 넣은 경우도 필터합니다.


<br>

---

</br>

## 🆙쿠퍼네티스 배포 

<details>
<summary>배포과정 보기(click)</summary>

 #로드맵#
![image](https://github.com/fa7271/som/assets/150704738/c752c768-3812-40f5-8084-195fcc2082b2)
---
![image](https://github.com/fa7271/som/assets/150704738/4846b3f0-9d36-4fe5-8a15-edb711c79f0b)
---
![image](https://github.com/fa7271/som/assets/150704738/14fd025c-cf65-4ba7-8d11-b9d722cf3694)
---
![image](https://github.com/fa7271/som/assets/150704738/e44f3a95-f2da-4848-a317-817b1d39cae3)
---
![image](https://github.com/fa7271/som/assets/150704738/64e1b8f6-2386-4ad4-9a79-5306de008134)
---
![image](https://github.com/fa7271/som/assets/150704738/81fe2771-9d0c-48d6-a622-bc4441b0b74d)
---
![image](https://github.com/fa7271/som/assets/150704738/4b29e87c-6126-44e3-b4c8-227714ccb5a0)
---
![image](https://github.com/fa7271/som/assets/150704738/63f25787-f06d-476f-b633-3b2a04254ce8)
---
![image](https://github.com/fa7271/som/assets/150704738/2edd4f93-3695-451e-8027-b21348ee6b1a)
---


</details>
<br>

---

</br>



##  📝테스트 및 결과

<details>
<summary>테스트 및 결과보기(click)</summary>
</details>

![footer](https://capsule-render.vercel.app/api?type=shark&height=200&text=Thank%20you&section=footer&reversal=true&fontColor=FFFFFF&fontAlign=83&fontAlignY=89&fontSize=38)



   




